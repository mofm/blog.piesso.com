<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Ignotum Per Ignotius">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>hardened .*(nt|log)s? (old posts, page 24) | hardened .*(nt|log)s?</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://blog.piesso.com/index-24.html">
<link rel="icon" href="images/website/favicon.ico" sizes="16x16">
<link rel="icon" href="images/website/favicon-32x32.png" sizes="32x32">
<link rel="icon" href="images/website/favicon-16x16.png" sizes="16x16">
<link rel="icon" href="images/website/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="images/website/android-chrome-512x512.png" sizes="512x512">
<link rel="icon" href="images/website/android-chrome-192x192.png" sizes="192x192">
<link rel="prev" href="." type="text/html">
<link rel="next" href="index-23.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href=".">

            <span id="blog-title">hardened .*(nt|log)s?</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="index.html" class="nav-link">Home</a>
                </li>
<li class="nav-item">
<a href="archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="pages/about-me" class="nav-link">About me</a>
                </li>
<li class="nav-item">
<a href="https://github.com/mofm" class="nav-link">Github</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/basic-timezone-api/" class="u-url">Basic Timezone API</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                mofm
            </span></p>
            <p class="dateline">
            <a href="posts/basic-timezone-api/" rel="bookmark">
            <time class="published dt-published" datetime="2021-12-18T02:16:01+03:00" itemprop="datePublished" title="2021-12-18 02:16">2021-12-18 02:16</time></a>
            </p>
                <p class="commentline">
    
        <a href="posts/basic-timezone-api/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>timezone-api is lightweight Flask app with TimezoneFinder(L) python library and
provides a simple interface. Your request the timezone information for specific
latitude and longtitude pair.</p>
<h3>Request Parameters</h3>
<p>Parameters are separated using the ampersand(&amp;) character.</p>
<ul>
<li>
<strong>lat</strong>: latitude (eg. lat=39.6034810) <em>(Required)</em>
</li>
<li>
<strong>lng</strong>: longtitude (eg. lng=-119.6822510) <em>(Required)</em>
</li>
<li>
<strong>timestamp</strong>: timestamp (eg. timestamp=1331161200) <em>(Required)</em>
</li>
</ul>
<h4>Example Request</h4>
<p><strong>Request:</strong></p>
<p>API urls must follow this format:</p>
<p><code>https://api.example.com/timezone/api?lng=-119.6822510&amp;lat=39.6034810&amp;timestamp=1331766000</code></p>
<p><strong>Response:</strong></p>
<p><code>{"dstoffset":3600.0,"rawoffset":-28800.0,"status":200,"tzname":"America/Los_Angeles"}</code></p>
<pre class="code literal-block"><span></span><code><span class="o">-</span> <span class="nv">tzname</span>: <span class="nv">Timezone</span> <span class="nv">name</span>
<span class="o">-</span> <span class="nv">dstoffset</span>: <span class="nv">the</span> <span class="nv">offset</span> <span class="k">for</span> <span class="nv">daylight</span><span class="o">-</span><span class="nv">savings</span> <span class="nv">time</span> <span class="nv">in</span> <span class="nv">seconds</span>.
<span class="nv">This</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">zero</span> <span class="k">if</span> <span class="nv">the</span> <span class="nv">time</span> <span class="nv">zone</span> <span class="nv">is</span> <span class="nv">not</span> <span class="nv">in</span> <span class="nv">Daylight</span> <span class="nv">Savings</span> <span class="nv">Time</span> <span class="nv">during</span> <span class="nv">the</span> <span class="nv">specified</span> <span class="nv">timestamp</span>.
<span class="o">-</span> <span class="nv">rawoffset</span>: <span class="nv">the</span> <span class="nv">offset</span> <span class="nv">from</span> <span class="nv">UTC</span> <span class="ss">(</span><span class="nv">in</span> <span class="nv">seconds</span><span class="ss">)</span> <span class="k">for</span> <span class="nv">the</span> <span class="nv">given</span> <span class="nv">location</span>.
<span class="nv">This</span> <span class="nv">does</span> <span class="nv">not</span> <span class="nv">take</span> <span class="nv">into</span> <span class="nv">effect</span> <span class="nv">daylight</span> <span class="nv">savings</span>.
<span class="o">-</span> <span class="nv">status</span>: <span class="nv">response</span> <span class="nv">code</span>
    <span class="o">-</span> <span class="mi">200</span>: <span class="nv">the</span> <span class="nv">request</span> <span class="nv">was</span> <span class="nv">successful</span>
    <span class="o">-</span> <span class="mi">400</span>: <span class="nv">missing</span> <span class="nv">parameter</span><span class="ss">(</span><span class="nv">s</span><span class="ss">)</span>
    <span class="o">-</span> <span class="mi">422</span>: <span class="nv">out</span> <span class="nv">of</span> <span class="nv">bounds</span> <span class="nv">error</span>
</code></pre>

<h3>API Health</h3>
<p>To check the API status or health</p>
<p><strong>Request:</strong></p>
<p><code>https://api.example.com/timezone/health/</code></p>
<p><strong>Response:</strong>
OK</p>
<h3>API Info</h3>
<p>For information about API</p>
<p><strong>Request:</strong></p>
<p><code>https://api.example.com/timezone/info/</code></p>
<p><strong>Response:</strong></p>
<p><code>{"debug":false,"running-since":1620688782.0930135,"version":"0.0.1"}</code></p>
<pre class="code literal-block"><span></span><code>- debug: APP debug status
- running-since: API start time
- version: API version
</code></pre>

<h3>Installation</h3>
<h4>I. Method: From Docker Hub</h4>
<pre class="code literal-block">$ docker run -d -p <span class="m">8080</span>:8000 --name timezone-35 mofm/timezone-api
</pre>
<ul>
<li>Test</li>
</ul>
<pre class="code literal-block">$ curl --request GET  <span class="s2">"http://127.0.0.1:8080/timezone/api/?lng=-119.6822510&amp;lat=39.6034810&amp;timestamp=1331766000"</span>
</pre>
<pre class="code literal-block"><span></span><code>{
  "dstoffset": 3600.0,
  "rawoffset": -28800.0,
  "status": 200,
  "tzname": "America/Los_Angeles"
}
</code></pre>

<h4>II. Method: Build Docker image</h4>
<ul>
<li>Clone this repostory</li>
</ul>
<pre class="code literal-block"><span></span><code>$ git clone https://github.com/mofm/timezone-api.git
</code></pre>

<ul>
<li>Build Docker image (slim image with Google Distroless)</li>
</ul>
<pre class="code literal-block"><span></span><code>docker build -t timezone-img .
</code></pre>

<ul>
<li>Running Docker image</li>
</ul>
<pre class="code literal-block"><span></span><code>$ docker run -d -p <span class="m">8080</span>:8000 --name timezone-api ti
</code></pre>

<ul>
<li>Test</li>
</ul>
<pre class="code literal-block"><span></span><code>$ curl --request GET  <span class="s2">"http://127.0.0.1:8080/timezone/api/?lng=-119.6822510&amp;lat=39.6034810&amp;timestamp=1331766000"</span>
</code></pre>

<pre class="code literal-block"><span></span><code>{
  "dstoffset": 3600.0,
  "rawoffset": -28800.0,
  "status": 200,
  "tzname": "America/Los_Angeles"
}
</code></pre>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/unbound-doh-behind-nginx/" class="u-url">Unbound DoH behind Nginx</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                mofm
            </span></p>
            <p class="dateline">
            <a href="posts/unbound-doh-behind-nginx/" rel="bookmark">
            <time class="published dt-published" datetime="2021-12-18T01:53:49+03:00" itemprop="datePublished" title="2021-12-18 01:53">2021-12-18 01:53</time></a>
            </p>
                <p class="commentline">
    
        <a href="posts/unbound-doh-behind-nginx/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Unbound DoH is waiting HTTP/2 requests. But Nginx proxy module doesn't support HTTP/2 on the upstream connections.
So you can use grpc proxy:</p>
<pre class="code bash"><a id="rest_code_4ae80ff653334620b9e867ea1a930101-1" name="rest_code_4ae80ff653334620b9e867ea1a930101-1"></a>location /dns-query <span class="o">{</span>
<a id="rest_code_4ae80ff653334620b9e867ea1a930101-2" name="rest_code_4ae80ff653334620b9e867ea1a930101-2"></a>     grpc_pass grpc://unbound-host<span class="p">;</span>
<a id="rest_code_4ae80ff653334620b9e867ea1a930101-3" name="rest_code_4ae80ff653334620b9e867ea1a930101-3"></a><span class="o">}</span>
</pre>
<p>and disable TLS for DNS-over-HTTP downstream service in unbound.conf:</p>
<pre class="code bash"><a id="rest_code_7699a653f2f648778593252551ee3d72-1" name="rest_code_7699a653f2f648778593252551ee3d72-1"></a>http-notls-downstream: yes
</pre>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/free-updated-geoip-databases/" class="u-url">Free Updated GeoIP Databases</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                mofm
            </span></p>
            <p class="dateline">
            <a href="posts/free-updated-geoip-databases/" rel="bookmark">
            <time class="published dt-published" datetime="2021-12-16T02:04:00+03:00" itemprop="datePublished" title="2021-12-16 02:04">2021-12-16 02:04</time></a>
            </p>
                <p class="commentline">
    
        <a href="posts/free-updated-geoip-databases/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>I found and use an up-to-date and free GeoIP databases from <a class="reference external" href="https://mailfud.org/geoip-legacy/">https://mailfud.org/geoip-legacy/</a> . There are 5 different GeoIP databases(<em>also IPv6</em>) :</p>
<ul class="simple">
<li><p>Country</p></li>
<li><p>City</p></li>
<li><p>ASN</p></li>
<li><p>ISP</p></li>
<li><p>Organization</p></li>
</ul>
<p>Also it has update script(<strong>geoip_update.sh</strong>). Thanks mailfud.org :)</p>
<p>You can test City database from <a class="reference external" href="https://ip.piesso.com">here</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/urls-of-blacklists/" class="u-url">URLs of Blacklists</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                mofm
            </span></p>
            <p class="dateline">
            <a href="posts/urls-of-blacklists/" rel="bookmark">
            <time class="published dt-published" datetime="2021-12-16T01:38:15+03:00" itemprop="datePublished" title="2021-12-16 01:38">2021-12-16 01:38</time></a>
            </p>
                <p class="commentline">
    
        <a href="posts/urls-of-blacklists/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Free, up-to-date and large blacklist databases for those who want to set up DNS firewall:</p>
<aside class="admonition note"><p class="admonition-title">Note</p>
<p>Updated: 2022/01/11
- added OISD</p>
</aside><table>
<thead><tr>
<th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>URL</strong></p></th>
</tr></thead>
<tbody>
<tr>
<td><p>Energized Protection</p></td>
<td><p><a class="reference external" href="https://block.energized.pro/">https://block.energized.pro/</a></p></td>
</tr>
<tr>
<td><p>OISD</p></td>
<td><p><a class="reference external" href="https://oisd.nl/">https://oisd.nl/</a></p></td>
</tr>
<tr>
<td><p>Abuse.ch</p></td>
<td><p><a class="reference external" href="https://threatfox.abuse.ch/">https://threatfox.abuse.ch/</a></p></td>
</tr>
<tr>
<td><p>Adaway</p></td>
<td><p><a class="reference external" href="https://adaway.org/">https://adaway.org/</a></p></td>
</tr>
<tr>
<td><p>Adguard List</p></td>
<td><p><a class="reference external" href="https://justdomains.github.io/blocklists/#the-lists">https://justdomains.github.io/blocklists/#the-lists</a></p></td>
</tr>
<tr>
<td><p>Blocklist.site</p></td>
<td><p><a class="reference external" href="https://github.com/blocklistproject/Lists">https://github.com/blocklistproject/Lists</a></p></td>
</tr>
<tr>
<td><p>EasyList</p></td>
<td><p><a class="reference external" href="https://justdomains.github.io/blocklists/#the-lists">https://justdomains.github.io/blocklists/#the-lists</a></p></td>
</tr>
<tr>
<td><p>Easyprivacy</p></td>
<td><p><a class="reference external" href="https://justdomains.github.io/blocklists/#the-lists">https://justdomains.github.io/blocklists/#the-lists</a></p></td>
</tr>
<tr>
<td><p>NoCoin List</p></td>
<td><p><a class="reference external" href="https://justdomains.github.io/blocklists/#the-lists">https://justdomains.github.io/blocklists/#the-lists</a></p></td>
</tr>
<tr>
<td><p>PornTop1M List</p></td>
<td><p><a class="reference external" href="https://github.com/chadmayfield/my-pihole-blocklists">https://github.com/chadmayfield/my-pihole-blocklists</a></p></td>
</tr>
<tr>
<td><p>Simple Ad List</p></td>
<td><p><a class="reference external" href="https://s3.amazonaws.com/lists.disconnect.me/simple_ad.txt">https://s3.amazonaws.com/lists.disconnect.me/simple_ad.txt</a></p></td>
</tr>
<tr>
<td><p>Simple Tracker List</p></td>
<td><p><a class="reference external" href="https://s3.amazonaws.com/lists.disconnect.me/simple_tracking.txt">https://s3.amazonaws.com/lists.disconnect.me/simple_tracking.txt</a></p></td>
</tr>
<tr>
<td><p>StevenBlack/hosts</p></td>
<td><p><a class="reference external" href="https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts">https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts</a></p></td>
</tr>
<tr>
<td><p>WindowsSpyBlocker</p></td>
<td><p><a class="reference external" href="https://github.com/crazy-max/WindowsSpyBlocker">https://github.com/crazy-max/WindowsSpyBlocker</a></p></td>
</tr>
<tr>
<td><p>YoYo List</p></td>
<td><p><a class="reference external" href="https://pgl.yoyo.org/adservers/">https://pgl.yoyo.org/adservers/</a></p></td>
</tr>
</tbody>
</table>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/block-ads-and-malware-via-bind9-rpz/" class="u-url">Block ads and malware via BIND9 RPZ</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                mofm
            </span></p>
            <p class="dateline">
            <a href="posts/block-ads-and-malware-via-bind9-rpz/" rel="bookmark">
            <time class="published dt-published" datetime="2021-12-15T21:57:56+03:00" itemprop="datePublished" title="2021-12-15 21:57">2021-12-15 21:57</time></a>
            </p>
                <p class="commentline">
    
        <a href="posts/block-ads-and-malware-via-bind9-rpz/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <h3>Installation on Ubuntu 20.04 LTS</h3>
<ul>
<li>Run following command to install BIND 9 on Ubuntu 20.04</li>
</ul>
<pre class="code literal-block"><span></span><code>$ sudo apt update
$ sudo apt install bind9 bind9utils bind9-dnsutils
</code></pre>

<h3>Configurations for recursive DNS resolver with RPZ(response policy zone)</h3>
<ul>
<li>To enable recursion service, edit <strong><em>/etc/bind/named.conf.options</em></strong> :</li>
</ul>
<pre class="code literal-block"><span></span><code>    <span class="o">//</span> <span class="nv">hide</span> <span class="nv">version</span> <span class="nv">number</span> <span class="nv">from</span> <span class="nv">clients</span> <span class="k">for</span> <span class="nv">security</span> <span class="nv">reasons</span>.
    <span class="nv">version</span> <span class="s2">"</span><span class="s">not currently available</span><span class="s2">"</span><span class="c1">;</span>

    <span class="o">//</span> <span class="nv">optional</span> <span class="o">-</span> <span class="nv">BIND</span> <span class="nv">default</span> <span class="nv">behavior</span> <span class="nv">is</span> <span class="nv">recursion</span>
    <span class="nv">recursion</span> <span class="nv">yes</span><span class="c1">;</span>

    <span class="o">//</span> <span class="nv">provide</span> <span class="nv">recursion</span> <span class="nv">service</span> <span class="nv">to</span> <span class="nv">trusted</span> <span class="nv">clients</span> <span class="nv">only</span>
    <span class="nv">allow</span><span class="o">-</span><span class="nv">recursion</span> { <span class="mi">127</span>.<span class="mi">0</span>.<span class="mi">0</span>.<span class="mi">1</span><span class="c1">; 192.168.0.0/24; 10.10.10.0/24; };</span>

    <span class="o">//</span> <span class="nv">disallow</span> <span class="nv">zone</span> <span class="nv">transfer</span>
    <span class="nv">allow</span><span class="o">-</span><span class="nv">transfer</span> { <span class="nv">none</span><span class="c1">; };</span>

    <span class="o">//</span> <span class="nv">enable</span> <span class="nv">the</span> <span class="nv">query</span> <span class="nv">log</span>
    <span class="nv">querylog</span> <span class="nv">yes</span><span class="c1">;</span>

    <span class="o">//</span><span class="nv">enable</span> <span class="nv">response</span> <span class="nv">policy</span> <span class="nv">zone</span>.
    <span class="nv">response</span><span class="o">-</span><span class="nv">policy</span> {
        <span class="nv">zone</span> <span class="s2">"</span><span class="s">blocked.local</span><span class="s2">"</span><span class="c1">;</span>
    }<span class="c1">;</span>
</code></pre>

<ul>
<li>Add RPZ zone in <strong><em>/etc/bind/named.conf.local</em></strong> :</li>
</ul>
<pre class="code literal-block"><span></span><code>    zone "blocked.local" {
        type master;
        file "/etc/bind/db.blocked.local";
        allow-query { localhost; };
        allow-transfer { localhost; };
    };
</code></pre>

<ul>
<li>add following lines in <strong><em>/etc/bind/named.conf</em></strong> to use separate log file for RPZ(recommended):</li>
</ul>
<pre class="code literal-block"><span></span><code>    <span class="n">logging</span> <span class="p">{</span>
        <span class="n">channel</span> <span class="n">blockedlog</span> <span class="p">{</span>
            <span class="n">file</span> <span class="s2">"/var/log/named/blocked-zone.log"</span> <span class="n">versions</span> <span class="n">unlimited</span> <span class="n">size</span> <span class="mi">100</span><span class="n">m</span><span class="p">;</span>
            <span class="nb">print</span><span class="o">-</span><span class="n">time</span> <span class="n">yes</span><span class="p">;</span>
            <span class="nb">print</span><span class="o">-</span><span class="n">category</span> <span class="n">yes</span><span class="p">;</span>
            <span class="nb">print</span><span class="o">-</span><span class="n">severity</span> <span class="n">yes</span><span class="p">;</span>
            <span class="n">severity</span> <span class="n">info</span><span class="p">;</span>
        <span class="p">};</span>
        <span class="n">category</span> <span class="n">rpz</span> <span class="p">{</span> <span class="n">blockedlog</span><span class="p">;</span> <span class="p">};</span>
    <span class="p">};</span>
</code></pre>

<ul>
<li>If <strong><em>/var/log/named/</em></strong> directory doesn't exist, create it and make bind as the owner:</li>
</ul>
<pre class="code literal-block"><span></span><code>$ sudo mkdir /var/log/named/
$ sudo chown bind:bind /var/log/named/ -R
</code></pre>

<h3>Creating Zone File</h3>
<ul>
<li>first, clone this repository:</li>
</ul>
<pre class="code literal-block"><span></span><code>$ git clone https://github.com/mofm/blocked-zone.git
</code></pre>

<ul>
<li>
<p>If there is domain(s) you want to block, you can add it to the blacklist file.</p>
</li>
<li>
<p>execute the blocked-zone.sh script(this script downloads StevenBlack host file and then creates RPZ zone file):</p>
</li>
</ul>
<pre class="code literal-block"><span></span><code>$ sudo bash blocked-zone.sh
</code></pre>

<h3>Check configurations and service:</h3>
<pre class="code literal-block"><span></span><code>$ sudo named-checkconf
$ sudo named-checkzone rpz /etc/bind/db.blocked.local
</code></pre>

<p>If no problem, restart and enable bind9 service;</p>
<pre class="code literal-block"><span></span><code>$ sudo systemctl restart bind9
$ sudo systemctl <span class="nb">enable</span> bind9
</code></pre>

<h3>Test:</h3>
<ul>
<li>You can run the dig command on the BIND server to see if RPZ is working:</li>
</ul>
<pre class="code literal-block"><span></span><code>$ dig A adskeeper.com @127.0.0.1
</code></pre>

<ul>
<li>You can also check '/var/log/named/blocked-zone.log' for query log:</li>
</ul>
<pre class="code literal-block"><span></span><code>$ sudo tail /var/log/named/blocked-zone.log
</code></pre>

<ul>
<li>READY, you can add this BIND9 host IP address to your host(s).</li>
</ul>
<h3>Optional</h3>
<ul>
<li>You can add cronjob for schedule update</li>
<li>You can change the URL to StevenBlack GitHub Hosts in <strong><em>blocked-zone.sh</em></strong>
</li>
<li>You can download and use auto-generated RPZ zone files from <a href="https://scripttiger.github.io/alts/">https://scripttiger.github.io/alts/</a>
</li>
<li>Also you can download and use abuse.ch RPZ zone file from <a href="https://urlhaus.abuse.ch/downloads/rpz/">https://urlhaus.abuse.ch/downloads/rpz/</a>
</li>
</ul>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ingress-path-redirection-appends-port/" class="u-url">Ingress path redirection appends port</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                mofm
            </span></p>
            <p class="dateline">
            <a href="posts/ingress-path-redirection-appends-port/" rel="bookmark">
            <time class="published dt-published" datetime="2020-12-08T02:29:14+03:00" itemprop="datePublished" title="2020-12-08 02:29">2020-12-08 02:29</time></a>
            </p>
                <p class="commentline">
    
        <a href="posts/ingress-path-redirection-appends-port/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Ingress bazi URL isteklerine container port'u ile redirect etmeye calistigi gibi bir sorunla karsilasabilirsiniz. Ornek olarak biraz daha acmak gerekirse;</p>
<pre class="code bash"><a id="rest_code_b1977335892e4a1ba9ea1edc324abca4-1" name="rest_code_b1977335892e4a1ba9ea1edc324abca4-1"></a>$ curl -I http://cafe.example.com/coffee/
<a id="rest_code_b1977335892e4a1ba9ea1edc324abca4-2" name="rest_code_b1977335892e4a1ba9ea1edc324abca4-2"></a>
<a id="rest_code_b1977335892e4a1ba9ea1edc324abca4-3" name="rest_code_b1977335892e4a1ba9ea1edc324abca4-3"></a>HTTP/1.1 <span class="m">200</span> OK
<a id="rest_code_b1977335892e4a1ba9ea1edc324abca4-4" name="rest_code_b1977335892e4a1ba9ea1edc324abca4-4"></a>Date: Mon, <span class="m">07</span> Dec <span class="m">2020</span> <span class="m">23</span>:47:21 GMT
<a id="rest_code_b1977335892e4a1ba9ea1edc324abca4-5" name="rest_code_b1977335892e4a1ba9ea1edc324abca4-5"></a>Content-Type: text/html
<a id="rest_code_b1977335892e4a1ba9ea1edc324abca4-6" name="rest_code_b1977335892e4a1ba9ea1edc324abca4-6"></a>Content-Length: <span class="m">87466</span>
<a id="rest_code_b1977335892e4a1ba9ea1edc324abca4-7" name="rest_code_b1977335892e4a1ba9ea1edc324abca4-7"></a>Connection: keep-alive
<a id="rest_code_b1977335892e4a1ba9ea1edc324abca4-8" name="rest_code_b1977335892e4a1ba9ea1edc324abca4-8"></a>Last-Modified: Mon, <span class="m">07</span> Dec <span class="m">2020</span> <span class="m">20</span>:48:36 GMT
<a id="rest_code_b1977335892e4a1ba9ea1edc324abca4-9" name="rest_code_b1977335892e4a1ba9ea1edc324abca4-9"></a>ETag: <span class="s2">"5fce9524-155aa"</span>
<a id="rest_code_b1977335892e4a1ba9ea1edc324abca4-10" name="rest_code_b1977335892e4a1ba9ea1edc324abca4-10"></a>Accept-Ranges: bytes
</pre>
<p>Yukarida goruldugu "<a class="reference external" href="http://cafe.example.com/coffee/">http://cafe.example.com/coffee/</a>" adresine gonderdigimiz istek saglikli sekilde "200" kodunu cevap olarak donuyor.
Birde "<a class="reference external" href="http://cafe.example.com/coffee">http://cafe.example.com/coffee</a>" seklinde istekte bulunarak test edelim:</p>
<pre class="code bash"><a id="rest_code_4fefecea1e154ec19a38aa67070dfbc6-1" name="rest_code_4fefecea1e154ec19a38aa67070dfbc6-1"></a>$ curl -I http://cafe.example.com/coffee
<a id="rest_code_4fefecea1e154ec19a38aa67070dfbc6-2" name="rest_code_4fefecea1e154ec19a38aa67070dfbc6-2"></a>
<a id="rest_code_4fefecea1e154ec19a38aa67070dfbc6-3" name="rest_code_4fefecea1e154ec19a38aa67070dfbc6-3"></a>HTTP/1.1 <span class="m">301</span> Moved Permanently
<a id="rest_code_4fefecea1e154ec19a38aa67070dfbc6-4" name="rest_code_4fefecea1e154ec19a38aa67070dfbc6-4"></a>Date: Sun, <span class="m">07</span> Dec <span class="m">2020</span> <span class="m">23</span>:52:48 GMT
<a id="rest_code_4fefecea1e154ec19a38aa67070dfbc6-5" name="rest_code_4fefecea1e154ec19a38aa67070dfbc6-5"></a>Content-Type: text/html
<a id="rest_code_4fefecea1e154ec19a38aa67070dfbc6-6" name="rest_code_4fefecea1e154ec19a38aa67070dfbc6-6"></a>Content-Length: <span class="m">169</span>
<a id="rest_code_4fefecea1e154ec19a38aa67070dfbc6-7" name="rest_code_4fefecea1e154ec19a38aa67070dfbc6-7"></a>Connection: keep-alive
<a id="rest_code_4fefecea1e154ec19a38aa67070dfbc6-8" name="rest_code_4fefecea1e154ec19a38aa67070dfbc6-8"></a>Location: http://cafe.example.com:8080/coffee
</pre>
<p>Bu ornek ise goruldugu gibi "<a class="reference external" href="http://hostname:cointainer_port/paths">http://hostname:cointainer_port/paths</a>" seklinde container portunu da ekleyerek sayfayi yanlis sekilde redirect etmeye calisiyor ve sayfa ulasilamaz oluyor.
Buradaki <strong>'8080'</strong> portu ingress'in arka tarafindaki nginx container'in yayin yapmakta olan portu.</p>
<p>Sorunun sebebine gelince, bu sorunun ingress ile hic bir alakasi yok. Hem <strong>kubernetes/ingress-nginx</strong> hem de <strong>nginxinc/nginx-ingress</strong> ingress controller'larinda nginx konfigurasyonu uzerindeki <a class="reference external" href="http://nginx.org/en/docs/http/ngx_http_core_module.html#port_in_redirect">port_in_redirect</a> degeri default olarak 'off' olarak.
Fakat arka tarafta calisan nginx container uzerindeki bu konfigurasyonu '<em>on</em>' yapilmissa bu durumla karsilasabilirsiniz. Bunu nginx.conf uzerinde '<em>port_in_redirect off;</em>' seklinde kapatarak yasanmasini engelleyebilirsiniz.</p>
<p>Asagidaki sekilde nginx.conf'u configmap'e ekleyerek nginx pod'un bu configmap'i kullanmasini saglayarak deployment yapabilirsiniz.</p>
<pre class="code yaml"><a id="rest_code_934010e236964d818277db20518f878c-1" name="rest_code_934010e236964d818277db20518f878c-1"></a><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="rest_code_934010e236964d818277db20518f878c-2" name="rest_code_934010e236964d818277db20518f878c-2"></a><span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<a id="rest_code_934010e236964d818277db20518f878c-3" name="rest_code_934010e236964d818277db20518f878c-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-4" name="rest_code_934010e236964d818277db20518f878c-4"></a>  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx-conf</span>
<a id="rest_code_934010e236964d818277db20518f878c-5" name="rest_code_934010e236964d818277db20518f878c-5"></a><span class="nt">data</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-6" name="rest_code_934010e236964d818277db20518f878c-6"></a>  <span class="nt">nginx.conf</span><span class="p">:</span> <span class="p p-Indicator">|</span>
<a id="rest_code_934010e236964d818277db20518f878c-7" name="rest_code_934010e236964d818277db20518f878c-7"></a>    <span class="no">worker_processes  1;</span>
<a id="rest_code_934010e236964d818277db20518f878c-8" name="rest_code_934010e236964d818277db20518f878c-8"></a>
<a id="rest_code_934010e236964d818277db20518f878c-9" name="rest_code_934010e236964d818277db20518f878c-9"></a>    <span class="no">error_log  /var/log/nginx/error.log warn;</span>
<a id="rest_code_934010e236964d818277db20518f878c-10" name="rest_code_934010e236964d818277db20518f878c-10"></a>    <span class="no">pid        /tmp/nginx.pid;</span>
<a id="rest_code_934010e236964d818277db20518f878c-11" name="rest_code_934010e236964d818277db20518f878c-11"></a>
<a id="rest_code_934010e236964d818277db20518f878c-12" name="rest_code_934010e236964d818277db20518f878c-12"></a>
<a id="rest_code_934010e236964d818277db20518f878c-13" name="rest_code_934010e236964d818277db20518f878c-13"></a>    <span class="no">events {</span>
<a id="rest_code_934010e236964d818277db20518f878c-14" name="rest_code_934010e236964d818277db20518f878c-14"></a>        <span class="no">worker_connections  1024;</span>
<a id="rest_code_934010e236964d818277db20518f878c-15" name="rest_code_934010e236964d818277db20518f878c-15"></a>    <span class="no">}</span>
<a id="rest_code_934010e236964d818277db20518f878c-16" name="rest_code_934010e236964d818277db20518f878c-16"></a>
<a id="rest_code_934010e236964d818277db20518f878c-17" name="rest_code_934010e236964d818277db20518f878c-17"></a>
<a id="rest_code_934010e236964d818277db20518f878c-18" name="rest_code_934010e236964d818277db20518f878c-18"></a>    <span class="no">http {</span>
<a id="rest_code_934010e236964d818277db20518f878c-19" name="rest_code_934010e236964d818277db20518f878c-19"></a>        <span class="no">proxy_temp_path /tmp/proxy_temp;</span>
<a id="rest_code_934010e236964d818277db20518f878c-20" name="rest_code_934010e236964d818277db20518f878c-20"></a>        <span class="no">client_body_temp_path /tmp/client_temp;</span>
<a id="rest_code_934010e236964d818277db20518f878c-21" name="rest_code_934010e236964d818277db20518f878c-21"></a>        <span class="no">fastcgi_temp_path /tmp/fastcgi_temp;</span>
<a id="rest_code_934010e236964d818277db20518f878c-22" name="rest_code_934010e236964d818277db20518f878c-22"></a>        <span class="no">uwsgi_temp_path /tmp/uwsgi_temp;</span>
<a id="rest_code_934010e236964d818277db20518f878c-23" name="rest_code_934010e236964d818277db20518f878c-23"></a>        <span class="no">scgi_temp_path /tmp/scgi_temp;</span>
<a id="rest_code_934010e236964d818277db20518f878c-24" name="rest_code_934010e236964d818277db20518f878c-24"></a>
<a id="rest_code_934010e236964d818277db20518f878c-25" name="rest_code_934010e236964d818277db20518f878c-25"></a>        <span class="no">include       /etc/nginx/mime.types;</span>
<a id="rest_code_934010e236964d818277db20518f878c-26" name="rest_code_934010e236964d818277db20518f878c-26"></a>        <span class="no">default_type  application/octet-stream;</span>
<a id="rest_code_934010e236964d818277db20518f878c-27" name="rest_code_934010e236964d818277db20518f878c-27"></a>
<a id="rest_code_934010e236964d818277db20518f878c-28" name="rest_code_934010e236964d818277db20518f878c-28"></a>        <span class="no">log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span>
<a id="rest_code_934010e236964d818277db20518f878c-29" name="rest_code_934010e236964d818277db20518f878c-29"></a>                          <span class="no">'$status $body_bytes_sent "$http_referer" '</span>
<a id="rest_code_934010e236964d818277db20518f878c-30" name="rest_code_934010e236964d818277db20518f878c-30"></a>                          <span class="no">'"$http_user_agent" "$http_x_forwarded_for"';</span>
<a id="rest_code_934010e236964d818277db20518f878c-31" name="rest_code_934010e236964d818277db20518f878c-31"></a>
<a id="rest_code_934010e236964d818277db20518f878c-32" name="rest_code_934010e236964d818277db20518f878c-32"></a>        <span class="no">access_log  /var/log/nginx/access.log  main;</span>
<a id="rest_code_934010e236964d818277db20518f878c-33" name="rest_code_934010e236964d818277db20518f878c-33"></a>
<a id="rest_code_934010e236964d818277db20518f878c-34" name="rest_code_934010e236964d818277db20518f878c-34"></a>        <span class="no">sendfile        on;</span>
<a id="rest_code_934010e236964d818277db20518f878c-35" name="rest_code_934010e236964d818277db20518f878c-35"></a>        <span class="no">#tcp_nopush     on;</span>
<a id="rest_code_934010e236964d818277db20518f878c-36" name="rest_code_934010e236964d818277db20518f878c-36"></a>
<a id="rest_code_934010e236964d818277db20518f878c-37" name="rest_code_934010e236964d818277db20518f878c-37"></a>        <span class="no">port_in_redirect off;</span>
<a id="rest_code_934010e236964d818277db20518f878c-38" name="rest_code_934010e236964d818277db20518f878c-38"></a>
<a id="rest_code_934010e236964d818277db20518f878c-39" name="rest_code_934010e236964d818277db20518f878c-39"></a>        <span class="no">keepalive_timeout  65;</span>
<a id="rest_code_934010e236964d818277db20518f878c-40" name="rest_code_934010e236964d818277db20518f878c-40"></a>
<a id="rest_code_934010e236964d818277db20518f878c-41" name="rest_code_934010e236964d818277db20518f878c-41"></a>        <span class="no">#gzip  on;</span>
<a id="rest_code_934010e236964d818277db20518f878c-42" name="rest_code_934010e236964d818277db20518f878c-42"></a>
<a id="rest_code_934010e236964d818277db20518f878c-43" name="rest_code_934010e236964d818277db20518f878c-43"></a>        <span class="no">include /etc/nginx/conf.d/*.conf;</span>
<a id="rest_code_934010e236964d818277db20518f878c-44" name="rest_code_934010e236964d818277db20518f878c-44"></a>    <span class="no">}</span>
<a id="rest_code_934010e236964d818277db20518f878c-45" name="rest_code_934010e236964d818277db20518f878c-45"></a>
<a id="rest_code_934010e236964d818277db20518f878c-46" name="rest_code_934010e236964d818277db20518f878c-46"></a><span class="nn">---</span>
<a id="rest_code_934010e236964d818277db20518f878c-47" name="rest_code_934010e236964d818277db20518f878c-47"></a>
<a id="rest_code_934010e236964d818277db20518f878c-48" name="rest_code_934010e236964d818277db20518f878c-48"></a><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id="rest_code_934010e236964d818277db20518f878c-49" name="rest_code_934010e236964d818277db20518f878c-49"></a><span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<a id="rest_code_934010e236964d818277db20518f878c-50" name="rest_code_934010e236964d818277db20518f878c-50"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-51" name="rest_code_934010e236964d818277db20518f878c-51"></a>  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coffee</span>
<a id="rest_code_934010e236964d818277db20518f878c-52" name="rest_code_934010e236964d818277db20518f878c-52"></a><span class="nt">spec</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-53" name="rest_code_934010e236964d818277db20518f878c-53"></a>  <span class="nt">replicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
<a id="rest_code_934010e236964d818277db20518f878c-54" name="rest_code_934010e236964d818277db20518f878c-54"></a>  <span class="nt">selector</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-55" name="rest_code_934010e236964d818277db20518f878c-55"></a>    <span class="nt">matchLabels</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-56" name="rest_code_934010e236964d818277db20518f878c-56"></a>      <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coffee</span>
<a id="rest_code_934010e236964d818277db20518f878c-57" name="rest_code_934010e236964d818277db20518f878c-57"></a>  <span class="nt">template</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-58" name="rest_code_934010e236964d818277db20518f878c-58"></a>    <span class="nt">metadata</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-59" name="rest_code_934010e236964d818277db20518f878c-59"></a>      <span class="nt">labels</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-60" name="rest_code_934010e236964d818277db20518f878c-60"></a>        <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coffee</span>
<a id="rest_code_934010e236964d818277db20518f878c-61" name="rest_code_934010e236964d818277db20518f878c-61"></a>    <span class="nt">spec</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-62" name="rest_code_934010e236964d818277db20518f878c-62"></a>      <span class="nt">containers</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-63" name="rest_code_934010e236964d818277db20518f878c-63"></a>      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">www</span>
<a id="rest_code_934010e236964d818277db20518f878c-64" name="rest_code_934010e236964d818277db20518f878c-64"></a>        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginxinc/nginx-unprivileged</span>
<a id="rest_code_934010e236964d818277db20518f878c-65" name="rest_code_934010e236964d818277db20518f878c-65"></a>        <span class="nt">ports</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-66" name="rest_code_934010e236964d818277db20518f878c-66"></a>        <span class="p p-Indicator">-</span> <span class="nt">containerPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
<a id="rest_code_934010e236964d818277db20518f878c-67" name="rest_code_934010e236964d818277db20518f878c-67"></a>        <span class="nt">volumeMounts</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-68" name="rest_code_934010e236964d818277db20518f878c-68"></a>        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx-conf</span>
<a id="rest_code_934010e236964d818277db20518f878c-69" name="rest_code_934010e236964d818277db20518f878c-69"></a>          <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/nginx/nginx.conf</span>
<a id="rest_code_934010e236964d818277db20518f878c-70" name="rest_code_934010e236964d818277db20518f878c-70"></a>          <span class="nt">subPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx.conf</span>
<a id="rest_code_934010e236964d818277db20518f878c-71" name="rest_code_934010e236964d818277db20518f878c-71"></a>          <span class="nt">readOnly</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="rest_code_934010e236964d818277db20518f878c-72" name="rest_code_934010e236964d818277db20518f878c-72"></a>
<a id="rest_code_934010e236964d818277db20518f878c-73" name="rest_code_934010e236964d818277db20518f878c-73"></a><span class="nn">---</span>
<a id="rest_code_934010e236964d818277db20518f878c-74" name="rest_code_934010e236964d818277db20518f878c-74"></a>
<a id="rest_code_934010e236964d818277db20518f878c-75" name="rest_code_934010e236964d818277db20518f878c-75"></a><span class="nn">---</span>
<a id="rest_code_934010e236964d818277db20518f878c-76" name="rest_code_934010e236964d818277db20518f878c-76"></a><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="rest_code_934010e236964d818277db20518f878c-77" name="rest_code_934010e236964d818277db20518f878c-77"></a><span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Service</span>
<a id="rest_code_934010e236964d818277db20518f878c-78" name="rest_code_934010e236964d818277db20518f878c-78"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-79" name="rest_code_934010e236964d818277db20518f878c-79"></a>  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coffee-svc</span>
<a id="rest_code_934010e236964d818277db20518f878c-80" name="rest_code_934010e236964d818277db20518f878c-80"></a><span class="nt">spec</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-81" name="rest_code_934010e236964d818277db20518f878c-81"></a>  <span class="nt">ports</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-82" name="rest_code_934010e236964d818277db20518f878c-82"></a>  <span class="p p-Indicator">-</span> <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
<a id="rest_code_934010e236964d818277db20518f878c-83" name="rest_code_934010e236964d818277db20518f878c-83"></a>    <span class="nt">targetPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
<a id="rest_code_934010e236964d818277db20518f878c-84" name="rest_code_934010e236964d818277db20518f878c-84"></a>    <span class="nt">protocol</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">TCP</span>
<a id="rest_code_934010e236964d818277db20518f878c-85" name="rest_code_934010e236964d818277db20518f878c-85"></a>    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
<a id="rest_code_934010e236964d818277db20518f878c-86" name="rest_code_934010e236964d818277db20518f878c-86"></a>  <span class="nt">selector</span><span class="p">:</span>
<a id="rest_code_934010e236964d818277db20518f878c-87" name="rest_code_934010e236964d818277db20518f878c-87"></a>    <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coffee</span>
</pre>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/kubernetes-static-website-git/" class="u-url">Kubernetes, Static Website, Git</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                mofm
            </span></p>
            <p class="dateline">
            <a href="posts/kubernetes-static-website-git/" rel="bookmark">
            <time class="published dt-published" datetime="2020-12-05T18:12:03+03:00" itemprop="datePublished" title="2020-12-05 18:12">2020-12-05 18:12</time></a>
            </p>
                <p class="commentline">
    
        <a href="posts/kubernetes-static-website-git/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Uzun bir aradan sonra Kubernetes ile ilgili bir konu ile yazilara basliyoruz. Bu yazida Kubernetes nedir? Ne degildir? gibi Kubernetes 101'den bahsetmek yerine bir senaryo ile ilgili sizlere fikir vermek istedim. Hemen kisaca senaryodan bahsedelim:</p>
<section id="senaryo"><h2>Senaryo:</h2>
<p>Gunumuzde insanlar blog yazilarini yayinlamak icin static websites generator'lardan(nikola, jekyll, hugo vb.) birini kullanmaya yoneliyor. Daha onceden siklikla Wordpress kullanilirken artik bu sekilde bir cozum kullanimin farkli sebepleri olabilir. Bunu simdilik irdelemeyecegim.
Bu senaryomuzda yukarda bahsettigimiz sekilde olusturdugunuz static websitenizi <em>"Kubernetes uzerine git ile nasil otomatik update edebiliriz?"</em> cozumu hakkinda fikir verecegim.
Senaryo semasinin ayrintilari asagidaki gibidir:</p>
<img alt="/images/k8s-web-git.png" src="images/k8s-web-git.png"><p>Senaryoyu biraz daha ayrintilandirmak gerekirse, en alt katmandan en uste dogru cikalim. Bu senaryo icin volume olarak node uzerindeki <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/volumes/#local">Local</a> diski kullandim. Bu production icin uygun olmasa da test ortamini olusturmak ve iki container'in ayni volume'u kullanabilmesi icin bunu sectim.</p>
<aside class="admonition warning"><p class="admonition-title">Warning</p>
<p>Production ortaminda kesinlikle local disk kullanmayin! Siz production ortamlariniz icin herhangi bir <em>Clustered File System</em> kullanabilirsiniz.</p>
</aside><section id="persistentvolume-ve-persistentvolumeclaim-olusturulmasi"><h3>PersistentVolume ve PersistentVolumeClaim Olusturulmasi:</h3>
<p>Burada bir noktaya deginmek gerekirse olusturacagimiz bu volume'u nginx container'i icin sadece readonly mount ederken git-sync icin ise hem read hem de write olacak sekilde mount edecegiz. git-sync belirledigimiz git reposunu buraya sync edecektir. Bu yuzden hem read hem write yetkisi gerekirken, nginx sadece sayfalari yayinlayacagi icin read yetkisi yeterlidir.</p>
<p><strong>PersistentVolume:</strong></p>
<pre class="code yaml"><a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-1" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-1"></a><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-2" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-2"></a><span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PersistentVolume</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-3" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-4" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-4"></a>  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-local-pv-01</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-5" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-5"></a><span class="nt">spec</span><span class="p">:</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-6" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-6"></a>  <span class="nt">capacity</span><span class="p">:</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-7" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-7"></a>    <span class="nt">storage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1Gi</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-8" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-8"></a>  <span class="nt">accessModes</span><span class="p">:</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-9" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-9"></a>  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-10" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-10"></a>  <span class="nt">persistentVolumeReclaimPolicy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Delete</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-11" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-11"></a>  <span class="nt">storageClassName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-local-storage</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-12" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-12"></a>  <span class="nt">local</span><span class="p">:</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-13" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-13"></a>    <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/mnt/disk1/vol1</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-14" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-14"></a>  <span class="nt">nodeAffinity</span><span class="p">:</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-15" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-15"></a>    <span class="nt">required</span><span class="p">:</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-16" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-16"></a>      <span class="nt">nodeSelectorTerms</span><span class="p">:</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-17" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-17"></a>      <span class="p p-Indicator">-</span> <span class="nt">matchExpressions</span><span class="p">:</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-18" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-18"></a>        <span class="p p-Indicator">-</span> <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes.io/hostname</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-19" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-19"></a>          <span class="nt">operator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">In</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-20" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-20"></a>          <span class="nt">values</span><span class="p">:</span>
<a id="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-21" name="rest_code_5ce23de2933b45e8b7ec74d9a9d78b52-21"></a>          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">node3</span>
</pre>
<p>Yukardaki sekilde sadece <em>node3</em> hostname'li node uzerindeki '/mnt/disk1/vol1/' uzerinde 1GB buyuklugunde persistentVolume olusturduk. Yukarida da belirttigim gibi kesinlikle production ortaminda local disk kullanmayin!</p>
<pre class="code bash"><a id="rest_code_3e6dfedd4d534b858c28bc920228f80a-1" name="rest_code_3e6dfedd4d534b858c28bc920228f80a-1"></a>$ kubectl apply -f pv.yaml
</pre>
<p>persistentVolume olusturtuktan sonra persistentVolumeClaim olusturalim.( "pv ve pvc nedir?" merak ediyorsaniz <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">buradan</a> )</p>
<p><strong>PersistentVolumeClaim:</strong></p>
<pre class="code yaml"><a id="rest_code_53923a7115d6400295af19d4c798ab1d-1" name="rest_code_53923a7115d6400295af19d4c798ab1d-1"></a><span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<a id="rest_code_53923a7115d6400295af19d4c798ab1d-2" name="rest_code_53923a7115d6400295af19d4c798ab1d-2"></a><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="rest_code_53923a7115d6400295af19d4c798ab1d-3" name="rest_code_53923a7115d6400295af19d4c798ab1d-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="rest_code_53923a7115d6400295af19d4c798ab1d-4" name="rest_code_53923a7115d6400295af19d4c798ab1d-4"></a>  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-claim-01</span>
<a id="rest_code_53923a7115d6400295af19d4c798ab1d-5" name="rest_code_53923a7115d6400295af19d4c798ab1d-5"></a><span class="nt">spec</span><span class="p">:</span>
<a id="rest_code_53923a7115d6400295af19d4c798ab1d-6" name="rest_code_53923a7115d6400295af19d4c798ab1d-6"></a>  <span class="nt">accessModes</span><span class="p">:</span>
<a id="rest_code_53923a7115d6400295af19d4c798ab1d-7" name="rest_code_53923a7115d6400295af19d4c798ab1d-7"></a>  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<a id="rest_code_53923a7115d6400295af19d4c798ab1d-8" name="rest_code_53923a7115d6400295af19d4c798ab1d-8"></a>  <span class="nt">storageClassName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-local-storage</span>
<a id="rest_code_53923a7115d6400295af19d4c798ab1d-9" name="rest_code_53923a7115d6400295af19d4c798ab1d-9"></a>  <span class="nt">resources</span><span class="p">:</span>
<a id="rest_code_53923a7115d6400295af19d4c798ab1d-10" name="rest_code_53923a7115d6400295af19d4c798ab1d-10"></a>    <span class="nt">requests</span><span class="p">:</span>
<a id="rest_code_53923a7115d6400295af19d4c798ab1d-11" name="rest_code_53923a7115d6400295af19d4c798ab1d-11"></a>      <span class="nt">storage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1Gi</span>
</pre>
<pre class="code bash"><a id="rest_code_8df022092a874de19dd12ba07a89ec01-1" name="rest_code_8df022092a874de19dd12ba07a89ec01-1"></a>$ kubectl apply -f pvc.yaml
</pre>
<p>Volume olusturdugumuza gore artik yayinlayacagimiz static websitesi icin deployment asamasina gecebiliriz.</p>
</section><section id="deployment"><h3>Deployment:</h3>
<p>Asagidaki sekilde deployment olusturalim:</p>
<pre class="code yaml"><a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-1" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-1"></a><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-2" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-2"></a><span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-3" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-4" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-4"></a>  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blog</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-5" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-5"></a><span class="nt">spec</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-6" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-6"></a>  <span class="nt">replicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-7" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-7"></a>  <span class="nt">selector</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-8" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-8"></a>    <span class="nt">matchLabels</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-9" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-9"></a>      <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blog</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-10" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-10"></a>  <span class="nt">template</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-11" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-11"></a>    <span class="nt">metadata</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-12" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-12"></a>      <span class="nt">labels</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-13" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-13"></a>        <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blog</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-14" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-14"></a>    <span class="nt">spec</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-15" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-15"></a>      <span class="nt">containers</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-16" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-16"></a>      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">git-sync</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-17" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-17"></a>        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">k8s.gcr.io/git-sync/git-sync:v3.2.0</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-18" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-18"></a>        <span class="nt">volumeMounts</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-19" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-19"></a>        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">www-persistent-storage</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-20" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-20"></a>          <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/git</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-21" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-21"></a>        <span class="nt">env</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-22" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-22"></a>        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GIT_SYNC_REPO</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-23" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-23"></a>          <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/user_name/blog.example.com.git</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-24" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-24"></a>        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GIT_SYNC_DEST</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-25" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-25"></a>          <span class="nt">value</span><span class="p">:</span> <span class="s">"blog"</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-26" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-26"></a>        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GIT_SYNC_WAIT</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-27" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-27"></a>          <span class="nt">value</span><span class="p">:</span> <span class="s">"10"</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-28" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-28"></a>      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">www</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-29" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-29"></a>        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginxinc/nginx-unprivileged</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-30" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-30"></a>        <span class="nt">ports</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-31" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-31"></a>        <span class="p p-Indicator">-</span> <span class="nt">containerPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-32" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-32"></a>        <span class="nt">volumeMounts</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-33" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-33"></a>        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">www-persistent-storage</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-34" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-34"></a>          <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/usr/share/nginx/html</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-35" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-35"></a>          <span class="nt">readOnly</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-36" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-36"></a>      <span class="nt">volumes</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-37" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-37"></a>      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">www-persistent-storage</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-38" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-38"></a>        <span class="nt">persistentVolumeClaim</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-39" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-39"></a>          <span class="nt">claimName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-claim-01</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-40" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-40"></a>      <span class="nt">nodeSelector</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-41" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-41"></a>        <span class="nt">kubernetes.io/hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">node3</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-42" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-42"></a>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-43" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-43"></a><span class="nn">---</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-44" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-44"></a><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-45" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-45"></a><span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Service</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-46" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-46"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-47" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-47"></a>  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blog-svc</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-48" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-48"></a><span class="nt">spec</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-49" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-49"></a>  <span class="nt">ports</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-50" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-50"></a>  <span class="p p-Indicator">-</span> <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-51" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-51"></a>    <span class="nt">targetPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-52" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-52"></a>    <span class="nt">protocol</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">TCP</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-53" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-53"></a>    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-54" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-54"></a>  <span class="nt">selector</span><span class="p">:</span>
<a id="rest_code_8b07d567ef784f84bbc0ac7195310adf-55" name="rest_code_8b07d567ef784f84bbc0ac7195310adf-55"></a>    <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blog</span>
</pre>
<p>git-sync environment degerlerinden GIT_SYNC_REPO yerine git reponuzu ve GIT_SYNC_DEST degerini isteginize gore degistirebilirsiniz.</p>
<pre class="code bash"><a id="rest_code_4f933359d82e4ebb9950d0c3cc749af4-1" name="rest_code_4f933359d82e4ebb9950d0c3cc749af4-1"></a>$ kubectl apply -f deployment.yaml
</pre>
<p>Deployment olusturulup tamamlandiktan sonra websitemizi yayinlamak icin ingress olusturabiliriz.</p>
<pre class="code yaml"><a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-1" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-1"></a><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1beta1</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-2" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-2"></a><span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-3" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-4" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-4"></a>  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blog-ingress</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-5" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-5"></a><span class="nt">spec</span><span class="p">:</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-6" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-6"></a>        <span class="c1">#  ingressClassName: nginx # use only with k8s version &gt;= 1.18.0</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-7" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-7"></a>  <span class="nt">rules</span><span class="p">:</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-8" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-8"></a>  <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blog.example.com</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-9" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-9"></a>    <span class="nt">http</span><span class="p">:</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-10" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-10"></a>      <span class="nt">paths</span><span class="p">:</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-11" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-11"></a>      <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/blog</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-12" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-12"></a>        <span class="nt">backend</span><span class="p">:</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-13" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-13"></a>          <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blog-svc</span>
<a id="rest_code_e4c79788b9af44e889ebccbf63da7c39-14" name="rest_code_e4c79788b9af44e889ebccbf63da7c39-14"></a>          <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</pre>
<pre class="code bash"><a id="rest_code_19b4524e3f884f78abb0e1c7d768e58c-1" name="rest_code_19b4524e3f884f78abb0e1c7d768e58c-1"></a>$ kubectl apply -f ingress.yaml
</pre>
<p>ingress tanimlamamiz da yapildigina gore <em>http://blog.example.com/blog</em> adresinden websitemize ulasabiliriz. Artik git uzerine sayfalarinizi push'ladiktan sonra sayfaniz otomatik guncellenecektir. Umarim size fikir vermistir.</p>
</section></section>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/openldap-schema-for-postfix/" class="u-url">OpenLDAP Schema for Postfix</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                mofm
            </span></p>
            <p class="dateline">
            <a href="posts/openldap-schema-for-postfix/" rel="bookmark">
            <time class="published dt-published" datetime="2018-03-31T20:43:33+03:00" itemprop="datePublished" title="2018-03-31 20:43">2018-03-31 20:43</time></a>
            </p>
                <p class="commentline">
    
        <a href="posts/openldap-schema-for-postfix/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>If you configure postfix-dovecot with OpenLDAP, you will need specific LDAP's attributes. So I have written a schema.</p>
<dl class="simple">
<dt>postfix-new.schema:</dt>
<dd><ul class="simple">
<li><p>4 Attributes ( mailacceptinggeneralid, maildrop, mailEnabled, mailQuota )</p></li>
<li><p>1 ObjectClass ( postfixUser )</p></li>
</ul></dd>
</dl>
<script src="https://gist.github.com/4eff37b5c0275416393344b687171848.js"></script><noscript>
<pre class="literal-block">olcattributetypes: {0}(1.3.6.1.4.1.4203.666.1.200 NAME 'mailacceptinggeneralid' 
    DESC 'Postfix mail local address alias attribute' 
    EQUALITY caseIgnoreMatch 
    SUBSTR caseIgnoreSubstringsMatch 
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15{1024})
    
olcattributetypes: {1}(1.3.6.1.4.1.4203.666.1.201 NAME 'maildrop' 
    DESC 'Postfix mail final destination attribute' 
    EQUALITY caseIgnoreMatch 
    SUBSTR caseIgnoreSubstringsMatch 
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15{1024})
    
olcattributetypes: {2}(1.3.6.1.4.1.4203.666.1.202 NAME 'mailEnabled' 
    DESC 'TRUE to enable, FALSE to disable account' 
    EQUALITY booleanMatch 
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.7 SINGLE-VALUE)
    
olcattributetypes: {3}(1.3.6.1.4.1.4203.666.1.203 NAME 'mailQuota' 
    DESC 'Mail quota limit in kilobytes' 
    EQUALITY caseExactIA5Match 
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.26)
    
olcobjectclasses: {0}(1.3.6.1.4.1.4203.666.1.100 NAME 'postfixUser' 
    DESC 'Postfix mail user class' 
    SUP top AUXILIARY
    MUST (maildrop)
    MAY(mailacceptinggeneralid $ mailEnabled $ mailQuota))
</pre>
</noscript>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/libvirt-ve-openvswitch/" class="u-url">Libvirt ve OpenvSwitch</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                mofm
            </span></p>
            <p class="dateline">
            <a href="posts/libvirt-ve-openvswitch/" rel="bookmark">
            <time class="published dt-published" datetime="2018-01-15T00:13:52+03:00" itemprop="datePublished" title="2018-01-15 00:13">2018-01-15 00:13</time></a>
            </p>
                <p class="commentline">
    
        <a href="posts/libvirt-ve-openvswitch/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Bu yazimda libvirt ile openvswitch entegrasyonu hakkinda giris seviyesinde adim atacagiz. Kurulum ve entegrasyona gecmeden
once bu iki yazilim nedir, ne degildir onlari taniyalim.</p>
<p><strong>Libvirt</strong> <a class="footnote-reference brackets" href="posts/libvirt-ve-openvswitch/#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> , Redhat tarafindan 2005'ten bu yana gelistirilmeye devam eden sanallastirma ortamlari icin daemon, API ve
yonetim aracidir.</p>
<img alt="/images/libvirt_hypervisors.png" src="images/libvirt_hypervisors.png"><p>Libvirt bilinen bir cok hypervisor'u desteklemektedir. Iste bunlardan bazilari:</p>
<ul class="simple">
<li><p>KVM</p></li>
<li><p>LXC</p></li>
<li><p>OpenVZ</p></li>
<li><p>Xen</p></li>
<li><p>User-mode Linux (UML)</p></li>
<li><p>Virtualbox</p></li>
<li><p>VMware ESX</p></li>
<li><p>VMware Workstation</p></li>
<li><p>Hyper-V</p></li>
<li><p>PowerVM</p></li>
<li><p>Parallels Workstation</p></li>
<li><p>Bhyve</p></li>
</ul>
<p><strong>OpenvSwitch</strong> <a class="footnote-reference brackets" href="posts/libvirt-ve-openvswitch/#footnote-2" id="footnote-reference-2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> , kisaca sanal multilayer network switchtir. OpenvSwitch, bir SDN switch olarak hypervisor uzerindeki sanal makineleri
fiziksel olarak ayri bulunan network switchler ile entegre calisarak yonetebilir.</p>
<img alt="/images/Distributed_Open_vSwitch_instance.png" src="images/Distributed_Open_vSwitch_instance.png"><p>Birden fazla protokolu desteklemektedir:</p>
<ul class="simple">
<li><p>NetFlow</p></li>
<li><p>sFlow</p></li>
<li><p>SPAN</p></li>
<li><p>RSPAN</p></li>
<li><p>CLI</p></li>
<li><p>LACP</p></li>
<li><p>802.1ag</p></li>
</ul>
<section id="kurulum"><h2>Kurulum:</h2>
<p>Paket yoneticiniz ile libvirt ve openvswitch kurulumunu yapalim. Siz kendi dagitiminiza ve paket yoneticinize gore kurulumu yapabilirsiniz.
Gentoo uzerinde, libvirt icin gerekli "USE FLAG"lari aktif edip kurulumunu yapalim.Binary dagitimlar icin buna gerek yoktur. Siz direk paket yoneticiniz ile kurulumu yapin.</p>
<p>/etc/portage/package.use/libvirt:</p>
<pre class="literal-block">app-emulation/libvirt macvtap vepa qemu virt-network</pre>
<p>Simdi kurulumu yapabiliriz.</p>
<pre class="code bash"><a id="rest_code_2865eb07d47e4f8692e2acf2db07bd4c-1" name="rest_code_2865eb07d47e4f8692e2acf2db07bd4c-1"></a><span class="c1"># emerge -av libvirt</span>
</pre>
<p>OpenvSwitch kurulumunu yapalim.</p>
<pre class="code bash"><a id="rest_code_9059d30b0ca74a6f9590d28e9334cc0f-1" name="rest_code_9059d30b0ca74a6f9590d28e9334cc0f-1"></a><span class="c1"># emerge -av openvswitch</span>
</pre>
<p>Sistem baslangici icin bu servisleri enable edelim.</p>
<pre class="code bash"><a id="rest_code_67cad5c8011e4cf8a24fca452348ac0f-1" name="rest_code_67cad5c8011e4cf8a24fca452348ac0f-1"></a><span class="c1"># rc-update add ovsdb-server default</span>
<a id="rest_code_67cad5c8011e4cf8a24fca452348ac0f-2" name="rest_code_67cad5c8011e4cf8a24fca452348ac0f-2"></a><span class="c1"># rc-update add ovs-vswitchd default</span>
<a id="rest_code_67cad5c8011e4cf8a24fca452348ac0f-3" name="rest_code_67cad5c8011e4cf8a24fca452348ac0f-3"></a><span class="c1"># rc-update add libvirtd default</span>
<a id="rest_code_67cad5c8011e4cf8a24fca452348ac0f-4" name="rest_code_67cad5c8011e4cf8a24fca452348ac0f-4"></a><span class="c1"># rc-update add libvirt-guests default</span>
</pre>
<aside class="admonition note"><p class="admonition-title">Note</p>
<p>openvswitch ve kvm kernel modullerinin yuklendiginden emin olunuz. Kernel uzerinde aktif etmek icin <a class="reference external" href="https://wiki.gentoo.org/wiki/QEMU_with_Open_vSwitch_network">openvswitch</a> , <a class="reference external" href="https://wiki.gentoo.org/wiki/QEMU">qemu</a>.</p>
</aside><p>Sistem acilisinda bu modullerin yuklenmesi icin</p>
<p>/etc/conf.d/modules:</p>
<pre class="literal-block">modules_4="openvswitch kvm kvm_intel tun"</pre>
<p>Servisleri baslatalim.</p>
<pre class="code bash"><a id="rest_code_e29d60f0c67349729bcdce6e92e01770-1" name="rest_code_e29d60f0c67349729bcdce6e92e01770-1"></a><span class="c1"># /etc/init.d/ovsdb-server start</span>
<a id="rest_code_e29d60f0c67349729bcdce6e92e01770-2" name="rest_code_e29d60f0c67349729bcdce6e92e01770-2"></a><span class="c1"># /etc/init.d/ovs-vswitchd start</span>
<a id="rest_code_e29d60f0c67349729bcdce6e92e01770-3" name="rest_code_e29d60f0c67349729bcdce6e92e01770-3"></a><span class="c1"># /etc/init.d/libvirtd start</span>
<a id="rest_code_e29d60f0c67349729bcdce6e92e01770-4" name="rest_code_e29d60f0c67349729bcdce6e92e01770-4"></a><span class="c1"># /etc/init.d/libvirt-guests start</span>
</pre>
<aside class="footnote brackets" id="footnote-1" role="note"><span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="posts/libvirt-ve-openvswitch/#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://libvirt.org/">https://libvirt.org/</a></p>
</aside><aside class="footnote brackets" id="footnote-2" role="note"><span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="posts/libvirt-ve-openvswitch/#footnote-reference-2">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="http://openvswitch.org">http://openvswitch.org</a></p>
</aside></section>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ansible-gentoo-portage-update/" class="u-url">Ansible Gentoo-Portage Update</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                mofm
            </span></p>
            <p class="dateline">
            <a href="posts/ansible-gentoo-portage-update/" rel="bookmark">
            <time class="published dt-published" datetime="2018-01-14T02:13:06+03:00" itemprop="datePublished" title="2018-01-14 02:13">2018-01-14 02:13</time></a>
            </p>
                <p class="commentline">
    
        <a href="posts/ansible-gentoo-portage-update/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Ansible Portage module <a class="footnote-reference brackets" href="posts/ansible-gentoo-portage-update/#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> ile Gentoo Linux sisteminizi guncelleyebilir ve upgrade edebilirsiniz. Asagidaki ornekte
Ilk once buildfarm adini verdigimiz sunucu uzerinde compile edilip diger gentoo sunucularimiza binary paketleri
elde edip guncellemelerini yapmaktadir.</p>
<p>Yukarda bahsettigim sekilde bir buildfarm sunucusu yani paketlerin compile edilecegi sunucuda binary paketleri uretip
diger sunuculara bu binary paketleri sunmak icin portage uzerinde "buildpkg" ozelligini aktif etmek gerekmektedir.</p>
<p><code class="docutils literal">/etc/portage/make.conf</code>:</p>
<pre class="code bash"><a id="rest_code_64dcfb81531d45b4b818e491f1cc0b7a-1" name="rest_code_64dcfb81531d45b4b818e491f1cc0b7a-1"></a><span class="nv">FEATURES</span><span class="o">=</span><span class="s2">"buildpkg"</span>
</pre>
<p>Diger Gentoo sunucularin buildfarm uzerindeki paketleri alabilmesi icin yayinlamasi gerekli. Bunun birden fazla sekilde
kendinize cozum saglayabilirsiniz. FTP, FTPS, NFS, SSH, HTTP, HTTPS gibi. Biz kucuk bir web sunucusu kurup paketleri bu sekilde yayinlayalim.</p>
<pre class="code bash"><a id="rest_code_708422cfbc9a4d6fb6514b9e34001460-1" name="rest_code_708422cfbc9a4d6fb6514b9e34001460-1"></a><span class="c1"># emerge -av www-servers/lighttpd</span>
</pre>
<p>lighttpd web sunucusunu kurduktan sonra olusturulan paketlerin buradan yayinlanmasini konfigure edelim."/etc/lighttpd/lighttpd.conf"
dosyasinin sonuna asagidaki iki satiri ekleyin.</p>
<p><code class="docutils literal">/etc/lighttpd/lighttpd.conf</code>:</p>
<pre class="code bash"><a id="rest_code_101c51a80c3e437eb814fc7baf627f87-1" name="rest_code_101c51a80c3e437eb814fc7baf627f87-1"></a>server.modules +<span class="o">=</span> <span class="o">(</span> <span class="s2">"mod_alias"</span> <span class="o">)</span>
<a id="rest_code_101c51a80c3e437eb814fc7baf627f87-2" name="rest_code_101c51a80c3e437eb814fc7baf627f87-2"></a>alias.url <span class="o">=</span> <span class="o">(</span> <span class="s2">"/packages"</span> <span class="o">=</span>&gt; <span class="s2">"/usr/portage/packages/"</span> <span class="o">)</span>
</pre>
<p>Artik web sunucumuzu baslatabiliriz.</p>
<pre class="code bash"><a id="rest_code_ffd33fff4fcc43c8a9cf6511df17eda9-1" name="rest_code_ffd33fff4fcc43c8a9cf6511df17eda9-1"></a><span class="c1"># rc-update add lighttpd default</span>
<a id="rest_code_ffd33fff4fcc43c8a9cf6511df17eda9-2" name="rest_code_ffd33fff4fcc43c8a9cf6511df17eda9-2"></a><span class="c1"># /etc/init.d/lighttpd start</span>
</pre>
<p>Buildfarm sunucumuz ile ayarlarimiz bu kadar. Artik diger sunucularimizi buildfarm sunucusu uzerinden binary paketleri
almasi icin konfigure edebiliriz.</p>
<p><code class="docutils literal">/etc/portage/make.conf</code>:</p>
<pre class="code bash"><a id="rest_code_e796edd5eb804957bbbdc159d78d40a3-1" name="rest_code_e796edd5eb804957bbbdc159d78d40a3-1"></a><span class="nv">FEATURES</span><span class="o">=</span><span class="s2">"getbinpkg"</span>
<a id="rest_code_e796edd5eb804957bbbdc159d78d40a3-2" name="rest_code_e796edd5eb804957bbbdc159d78d40a3-2"></a><span class="nv">PORTAGE_BINHOST</span><span class="o">=</span><span class="s2">"http://buildfarm.hostname/packages"</span>
</pre>
<p>Artik ansible ile sistemizi ilk once buildfarm ile derlenip binary paketler ile diger sunucularinizi guncelleyebilirsiniz.</p>
<script src="https://gist.github.com/843654e91765dee16e64814bd3ba76af.js"></script><noscript>
<pre class="literal-block">---
- hosts: buildfarm
  become: true
  remote_user: jack
  become_method: sudo

  tasks:
    - portage:
         package: '@world'
         newuse: yes
         update: yes
         deep: yes
         sync: yes

- hosts: webservers
  become: true
  remote_user: jack
  become_method: sudo

  tasks:
    - portage:
         package: '@world'
         newuse: yes
         update: yes
         deep: yes
         sync: yes</pre>
</noscript>
<aside class="footnote brackets" id="footnote-1" role="note"><span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="posts/ansible-gentoo-portage-update/#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="http://docs.ansible.com/ansible/latest/portage_module.html">http://docs.ansible.com/ansible/latest/portage_module.html</a></p>
</aside>
</div>
    </article>
</div>

        <ul class="pager postindexpager clearfix">
<li class="previous"><a href="." rel="prev">Newer posts</a></li>
            <li class="next"><a href="index-23.html" rel="next">Older posts</a></li>
        </ul>
<!--End of body content--><footer id="footer">
            Contents © 2022         <a href="mailto:emre.eryilmaz@piesso.com">mofm</a> - Powered by         <a href="https://getnikola.com" rel="nofollow" target="_blank">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script src="https://polyfill.io/v3/polyfill.js?features=Intl.RelativeTimeFormat.%7Elocale.en"></script><script src="assets/js/luxon.min.js"></script><!-- fancy dates --><script>
        luxon.Settings.defaultLocale = "en";
        fancydates(2, {"preset": false, "format": "yyyy-MM-dd HH:mm"});
        </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
