<p>Unbound DoH is waiting HTTP/2 requests. But Nginx proxy module doesn't support HTTP/2 on the upstream connections.
So you can use grpc proxy:</p>
<pre class="code bash"><a id="rest_code_4ae80ff653334620b9e867ea1a930101-1" name="rest_code_4ae80ff653334620b9e867ea1a930101-1"></a>location /dns-query <span class="o">{</span>
<a id="rest_code_4ae80ff653334620b9e867ea1a930101-2" name="rest_code_4ae80ff653334620b9e867ea1a930101-2"></a>     grpc_pass grpc://unbound-host<span class="p">;</span>
<a id="rest_code_4ae80ff653334620b9e867ea1a930101-3" name="rest_code_4ae80ff653334620b9e867ea1a930101-3"></a><span class="o">}</span>
</pre><p>and disable TLS for DNS-over-HTTP downstream service in unbound.conf:</p>
<pre class="code bash"><a id="rest_code_7699a653f2f648778593252551ee3d72-1" name="rest_code_7699a653f2f648778593252551ee3d72-1"></a>http-notls-downstream: yes
</pre>